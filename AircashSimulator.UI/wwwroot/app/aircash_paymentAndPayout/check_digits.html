<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <h4>CheckDigits</h4>

    <p>
        Method used by the partner system to check whether there is an active transaction in the Aircash system for a given digit code. <br />
    </p>

    <div class="table-responsive">
        <table class="table table-active col-md-6">
            <thead>
                <tr>
                    <th>Environment</th>
                    <th>Method</th>
                    <th>URL</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><b>Test</b></td>
                    <td>
                        POST
                    </td>
                    <td>https://staging-api.aircash.eu/v2/api/SalesPartnerV2/CheckDigits</td>
                </tr>
                <tr>
                    <td><b>Production</b></td>
                    <td>
                        POST
                    </td>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </div>

    <uib-tabset>
        <uib-tab index="CheckDigits-tab-0" heading="Request parameters" classes="nav-item">
            <div class="table-responsive">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                            <th>Required</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><b>DigitCode</b></td>
                            <td>String</td>
                            <td>Six digit code receieved from user</td>
                            <td>YES</td>
                        </tr>
                        <tr>
                            <td><b>PartnerID</b></td>
                            <td>String</td>
                            <td>Partner identifier</td>
                            <td>YES</td>
                        </tr>
                        <tr>
                            <td><b>LocationID</b></td>
                            <td>String</td>
                            <td>Sales partner location identifier</td>
                            <td>NO</td>
                        </tr>
                        <tr>
                            <td><b>CurrencyID</b></td>
                            <td>Integer</td>
                            <td>ISO-4217 currency code</td>
                            <td>YES</td>
                        </tr>
                        <tr>
                            <td><b>Signature</b></td>
                            <td>String</td>
                            <td>
                                Signature to confirm that the partner is indeed making the request. Data to sign is ????????????????
                            </td>
                            <td>YES</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </uib-tab>
        <uib-tab index="CheckDigits-tab-1" heading="Request example" classes="nav-item">
            <jsonformatter data="SalesPartner.CheckDigits.RequestExample"></jsonformatter>
        </uib-tab>
        <uib-tab index="CheckCode-tab-2" heading="Signature" classes="nav-item">
            <pre>
Request example:
</pre>
            <jsonformatter data="SalesPartner.CheckDigits.RequestExample"></jsonformatter>
            <pre>

Sequence:
CurrencyID=978&DigitCode=687502&LocationID=TestLocation&PartnerID=e747a837-85d9-4287-a412-ffbb5d1b0ad8
		
Signature:
YccoFlj+81FWWO2KrR88xVOHiCs95wQLvA/PkNSIEemtyBbbJZZs/1JJ67JvCJl3o1ULxjYADNGLA5Ckr2uvo9RJxxrv1CPOZKCJffGFA4aBFCqrfZjOs8O0lbP3J61uBctM0NXTY1vuLXuYmLtPouQ28wnZuUI4PzaEqyUZt7qNkfrrgQIo0pU+VeHqkFQVApl81wBN7/oxCWGtcOYrBcCUjdOmVOEv1hosJUu21cTyeDjWzGm62Xx0pPcqGv74vzmk9Ok5jrLw7FdaNBrYWS4ohXZGcm0NqEk+h4mWDsLzz6tD8RrvXLFX5cIAO6hbKQbgsJ29QjSQQZI1Q3RKcWECVfKP1ub8WLx3I09NHIG/8txPBIKGRsGK1X5FXIuLmfVHVd09kAGcf1X8UYT0Iy5AZ0f3OVEl884ec1iRBhi6KKkEEV6bsz1j0KxFcpt2eRYa+A9RDLQ9o16RILubzFc+T+B4X0Ea9/IrlXkXJ4w8XLDiCZOrp3ZW4Gem1RfrM+hGjhvPyuFQakmX/e0kFqwUlTJSn5b/G7M/2a0VmpAWFU2nSMmOL8JI7xU1A8TGCPQQ08QS4ZefE+xBW4WkCT+AvGb8Am4neLYOqeGeJwpdUod0Zafqq4x4z7C/aegTft4PnhYAjut8ifwUiPDXP+pxQKZ0nitCCWvsjBRrK6s=


</pre>
        </uib-tab>
        <uib-tab index="CheckDigits-tab-3" heading="Response parameters" classes="nav-item">
            <div class="table-responsive">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                            <th>Required</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><b>DigitCode</b></td>
                            <td>String</td>
                            <td>Digit code that was sent in the request</td>
                            <td>YES</td>
                        </tr>
                        <tr>
                            <td><b>BarCode</b></td>
                            <td>String</td>
                            <td></td>
                            <td>YES</td>
                        </tr>
                        <tr>
                            <td><b>Amount</b></td>
                            <td>Number</td>
                            <td>
                                A positive amount represents payment (cashier takes the money from the user), and a negative amount represents payout (cashier hands the money to the user)
                            </td>
                            <td>YES</td>
                        </tr>
                        <tr>
                            <td><b>CurrencyID</b></td>
                            <td>Integer</td>
                            <td>ISO-4217 currency code</td>
                            <td>YES</td>
                        </tr>
                        <tr>
                            <td><b>FirstName</b></td>
                            <td>String</td>
                            <td>Aircash user first name</td>
                            <td>YES</td>
                        </tr>
                        <tr>
                            <td><b>LastName</b></td>
                            <td>String</td>
                            <td>Aircash user last name</td>
                            <td>YES</td>
                        </tr>
                        <tr>
                            <td><b>DateOfBirth</b></td>
                            <td>DateTime</td>
                            <td>Aircash user date of birth</td>
                            <td>YES</td>
                        </tr>
</table>
            </div>
            <hr />
            <p class="ml-3">
                <b>*NOTE:</b> Parameters in the table are included in each response, but you need to support new parameters as well, although you may not use them. If Aircash adds a new parameter, your system needs to accept the response with additional parameter(s).
            </p>
        </uib-tab>
        <uib-tab index="CheckDigits-tab-4" heading="Response example" classes="nav-item">
            <jsonformatter data="SalesPartner.CheckDigits.ResponseExampleV2"></jsonformatter>
        </uib-tab>
        <uib-tab index="CheckDigits-tab-5" heading="Error response messages" classes="nav-item">
            <div class="table-responsive">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>Http response</th>
                            <th>Description</th>
                            <th>Error Code</th>
                            <th>Message</th>
                            <th>Solution</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><b>401</b></td>
                            <td>
                                The partner is sending an unknown partner ID, or the signature is not valid.
                            </td>
                            <td>-</td>
                            <td>-</td>
                            <td>
                                Check all of the parameters that are being sent. If all parameters look good, contact Aircash support.
                            </td>
                        </tr>
                        <tr>
                            <td rowspan="4"><b>400</b></td>
                            <td rowspan="4">
                                An invalid request was made. The response will contain an error code and message
                            </td>
                            <td><b>2</b></td>
                            <td>Bar code already used</td>
                            <td>
                                The barcode was already used.
                            </td>
                        </tr>
                        <tr>
                            <td><b>3</b></td>
                            <td>Transaction limit</td>
                            <td>
                                The user has reached one or more Aircash system limits, and the transaction was refused. The exact reason of the refusal will be visible to the user in the Aircash app. In case of withdrawal if there are not enough funds on the wallet, this error will appear and the bar code will be used.
                            </td>
                        </tr>
                        <tr>
                            <td><b>4</b></td>
                            <td>PartnerTransactionID is not unique</td>
                            <td>
                                Partner transaction ID is not unique for this sales partner. Aircash suggests using Guid for PartnerTransactionIDs to avoid this.
                            </td>
                        </tr>
                        <tr>
                            <td><b>6</b></td>
                            <td>Unable to confirm transaction without calling check bar code first</td>
                            <td>
                                First you have to call check code in order to confirm the transaction
                            </td>
                        </tr>
                        <tr>
                            <td><b>500</b></td>
                            <td>
                                Unexpected system error
                            </td>
                            <td>-</td>
                            <td>-</td>
                            <td>
                                Try again until the system recovers.
                            </td>
                        </tr>
                </table>
            </div>
            <p>
                Corner cases<br />
                In case of Aircash system not returning a response to a ConfirmTransaction call, or
                responding with an error 500, the sales partner system should check the transaction status in
                Aircash system by calling the CheckTransactionStatus method.
            </p>
        </uib-tab>
        <uib-tab index="CheckDigits-tab-6" heading="Error response example" classes="nav-item">
            <uib-tabset class="row tabs-left">
                <uib-tab index="CheckDigitsError-tab-1" heading="2 - Bar code already used" classes="nav-item">
                    <div class="row col-12">
                        <div class="col-sm-6 overflow-auto" ng-if="!(errorConfirmResponded && confirmCurrentErrorCode == 2)">
                            Request
                            <jsonformatter data="errorExamples.CheckDigits.error2.request"></jsonformatter>

                            Sequence:
                            BarCode=AC15694794016276&LocationID=123&PartnerID=e747a837-85d9-4287-a412-ffbb5d1b0ad8&PartnerTransactionID=d8b5649c-3001-4c12-bc45-f024d67585c6
                        </div>
                        <div class="col-sm-6" ng-if="!(errorConfirmResponded && confirmCurrentErrorCode == 2)">
                            Response
                            <jsonformatter data="errorExamples.CheckDigits.error2.response"></jsonformatter>
                        </div>
                        <div class="col-sm-6 overflow-auto" ng-if="errorConfirmResponded && confirmCurrentErrorCode == 2">
                            Request ({{errorConfirmRequestDateTimeUTC| date:'yyyy-MM-dd HH:mm:ss.sss'}})
                            <jsonformatter data="errorConfirmRequest"></jsonformatter>

                            Sequence: {{errorConfirmSequence}}<br />

                        </div>
                        <div class="col-sm-6" ng-if="errorConfirmResponded && confirmCurrentErrorCode == 2">
                            Response ({{errorConfirmResponseDateTimeUTC| date:'yyyy-MM-dd HH:mm:ss.sss'}})
                            <jsonformatter data="errorConfirmResponse"></jsonformatter>
                        </div>
                    </div>
                    <button class="btn btn-primary mt-2" ng-click="confirmSimulateError(2)" ng-disabled="errorConfirmServiceBusy">Simulate <i ng-if="errorConfirmServiceBusy" class="fa fa-cog fa-spin"></i></button>
                    <button class="btn btn-white mt-2" ng-click="copyToClipboard(errorConfirmRequestCopy)" ng-if="errorConfirmResponded && confirmCurrentErrorCode == 2">Copy Request</button>
                </uib-tab>
                <uib-tab index="CheckDigitsError-tab-2" heading="3 - Transaction limit" classes="nav-item">
                    Simulation not available.
                    <!--<div class="row col-12">
                        <div class="col-sm-6 overflow-auto" ng-if="!(errorConfirmResponded && confirmCurrentErrorCode == 3)">
                            Request
                            <jsonformatter data="errorExamples.ConfirmTransaction.error3.request"></jsonformatter>

                            Sequence:

                        </div>
                        <div class="col-sm-6" ng-if="!(errorConfirmResponded && confirmCurrentErrorCode == 3)">
                            Response
                            <jsonformatter data="errorExamples.ConfirmTransaction.error3.response"></jsonformatter>
                        </div>
                        <div class="col-sm-6 overflow-auto" ng-if="errorConfirmResponded && confirmCurrentErrorCode == 3">
                            Request ({{errorConfirmRequestDateTimeUTC| date:'yyyy-MM-dd HH:mm:ss.sss'}})
                            <jsonformatter data="errorConfirmRequest"></jsonformatter>

                            Sequence: {{errorConfirmSequence}}<br />

                        </div>
                        <div class="col-sm-6" ng-if="errorConfirmResponded && confirmCurrentErrorCode == 3">
                            Response ({{errorConfirmResponseDateTimeUTC| date:'yyyy-MM-dd HH:mm:ss.sss'}})
                            <jsonformatter data="errorConfirmResponse"></jsonformatter>
                        </div>
                    </div>-->
                    <!--<button class="btn btn-primary mt-2" ng-click="confirmSimulateError(3)" ng-disabled="errorConfirmServiceBusy">Simulate <i ng-if="errorConfirmServiceBusy" class="fa fa-cog fa-spin"></i></button>-->
                    <!--<button class="btn btn-white mt-2" ng-click="copyToClipboard(errorConfirmRequestCopy)" ng-if="errorConfirmResponded && confirmCurrentErrorCode == 3">Copy Request</button>-->
                </uib-tab>
                <uib-tab index="CheckDigitsError-tab-3" heading="4 - Partner Transaction ID is not unique" classes="nav-item">
                    <div class="row col-12">
                        <div class="col-sm-6 overflow-auto" ng-if="!(errorConfirmResponded && confirmCurrentErrorCode == 4)">
                            Request
                            <jsonformatter data="errorExamples.CheckDigits.error4.request"></jsonformatter>

                            Sequence:
                            BarCode=AC16758848507711&LocationID=123&PartnerID=e747a837-85d9-4287-a412-ffbb5d1b0ad8&PartnerTransactionID=c456eee8-ccaa-4c10-b6e9-7f8c9ca3d2d8
                        </div>
                        <div class="col-sm-6" ng-if="!(errorConfirmResponded && confirmCurrentErrorCode == 4)">
                            Response
                            <jsonformatter data="errorExamples.CheckDigits.error4.response"></jsonformatter>
                        </div>
                        <div class="col-sm-6 overflow-auto" ng-if="errorConfirmResponded && confirmCurrentErrorCode == 4">
                            Request ({{errorConfirmRequestDateTimeUTC| date:'yyyy-MM-dd HH:mm:ss.sss'}})
                            <jsonformatter data="errorConfirmRequest"></jsonformatter>

                            Sequence: {{errorConfirmSequence}}<br />

                        </div>
                        <div class="col-sm-6" ng-if="errorConfirmResponded && confirmCurrentErrorCode == 4">
                            Response ({{errorConfirmResponseDateTimeUTC| date:'yyyy-MM-dd HH:mm:ss.sss'}})
                            <jsonformatter data="errorConfirmResponse"></jsonformatter>
                        </div>
                    </div>
                    <button class="btn btn-primary mt-2" ng-click="confirmSimulateError(4)" ng-disabled="errorConfirmServiceBusy">Simulate <i ng-if="errorConfirmServiceBusy" class="fa fa-cog fa-spin"></i></button>
                    <button class="btn btn-white mt-2" ng-click="copyToClipboard(errorConfirmRequestCopy)" ng-if="errorConfirmResponded && confirmCurrentErrorCode == 4">Copy Request</button>
                </uib-tab>
                <uib-tab index="CheckDigitsError-tab-4" heading="6 - Unable to confirm transaction without calling check bar code first" classes="nav-item">
                    <div class="row col-12">
                        <div class="col-sm-6 overflow-auto" ng-if="!(errorConfirmResponded && confirmCurrentErrorCode == 6)">
                            Request
                            <jsonformatter data="errorExamples.CheckDigits.error6.request"></jsonformatter>

                            Sequence:
                            BarCode=AC16004150724597&LocationID=123&PartnerID=e747a837-85d9-4287-a412-ffbb5d1b0ad8&PartnerTransactionID=b9258777-26bd-4863-a9fd-4046e7e4df71
                        </div>
                        <div class="col-sm-6" ng-if="!(errorConfirmResponded && confirmCurrentErrorCode == 6)">
                            Response
                            <jsonformatter data="errorExamples.CheckDigits.error6.response"></jsonformatter>
                        </div>
                        <div class="col-sm-6 overflow-auto" ng-if="errorConfirmResponded && confirmCurrentErrorCode == 6">
                            Request ({{errorConfirmRequestDateTimeUTC| date:'yyyy-MM-dd HH:mm:ss.sss'}})
                            <jsonformatter data="errorConfirmRequest"></jsonformatter>

                            Sequence: {{errorConfirmSequence}}<br />

                        </div>
                        <div class="col-sm-6" ng-if="errorConfirmResponded && confirmCurrentErrorCode == 6">
                            Response ({{errorConfirmResponseDateTimeUTC| date:'yyyy-MM-dd HH:mm:ss.sss'}})
                            <jsonformatter data="errorConfirmResponse"></jsonformatter>
                        </div>
                    </div>
                    <button class="btn btn-primary mt-2" ng-click="confirmSimulateError(6)" ng-disabled="errorConfirmServiceBusy">Simulate <i ng-if="errorConfirmServiceBusy" class="fa fa-cog fa-spin"></i></button>
                    <button class="btn btn-white mt-2" ng-click="copyToClipboard(errorConfirmRequestCopy)" ng-if="errorConfirmResponded && confirmCurrentErrorCode == 6">Copy Request</button>
                </uib-tab>
            </uib-tabset>
        </uib-tab>
        <uib-tab index="CheckDigits-tab-7" heading="Try it out" classes="nav-item">
            <div class="row">
                <div class="col-md-4">
                    <form action="/" method="POST" name="requestCheckDigitForm">
                        <fieldset>
                            <div class="mb-3">
                                <label class="form-label">PartnerID</label>
                                <input ng-model="checkDigitsModel.partnerId" class="form-control" type="text" placeholder="Enter PartnerId" ng-disabled="checkDigitsServiceBusy" ng-required="true">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">DigitCode</label>
                                <input ng-model="checkDigitsModel.digitCode" class="form-control" type="text" placeholder="Enter DigitCode" ng-disabled="checkDigitsServiceBusy" ng-required="true">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">LocationID</label>
                                <input ng-model="checkDigitsModel.locationID" class="form-control" type="text" placeholder="Enter LocationID" ng-disabled="checkDigitsServiceBusy">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">CurrencyID</label>
                                <input ng-model="checkDigitsModel.currencyID" class="form-control" type="text" placeholder="Enter CurrencyID" ng-disabled="checkDigitsServiceBusy" ng-required="true">
                            </div>
                            <button ng-click="checkDigits()" class="btn btn-primary w-100px me-5px" ng-disabled="checkDigitsServiceBusy || requestCheckDigitForm.$invalid">Check <i ng-if="checkDigitsServiceBusy" class="fa fa-cog fa-spin"></i></button>
                        </fieldset>
                    </form>
                </div>
                <div class="col-md-4" ng-if="checkDigitsServiceResponded">
                    Request ({{checkDigitsRequestDateTimeUTC| date:'yyyy-MM-dd HH:mm:ss.sss'}})
                    <jsonformatter data="checkDigitsServiceRequest"></jsonformatter>
                    Sequence: {{checkDigitsSequence}}<br />
                </div>
                <div class="col-md-4" ng-if="checkDigitsServiceResponded">
                    Response ({{checkDigitsResponseDateTimeUTC| date:'yyyy-MM-dd HH:mm:ss.sss'}})
                    <jsonformatter data="checkDigitsServiceResponse"></jsonformatter>
                </div>
            </div>
        </uib-tab>
    </uib-tabset>

</body>
</html>