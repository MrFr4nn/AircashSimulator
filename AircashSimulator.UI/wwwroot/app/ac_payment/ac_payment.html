<h1 style="text-align:justify">Payment process</h1>
<br />
<p style="text-align:justify">
    This chapter describes the top up process using the Aircash application. The described
    process explains how the user can transfer funds from the Aircash system to the partner system.
    <br />
    <br />
    The transfer process consists of three steps:
    <ol>
        <li>
            <b>Check if user exists in partner system (CheckPlayer)</b>
            <ul>
                <li>
                    The user within the Aircash application must enter a unique identifier of his account
                    in the partner system
                </li>
                <li>
                    A unique identifier may consist of one or more parameters, but must uniquely
                    indicate where the user funds will be transferred
                </li>
                <li>
                    In case the user is not sure which identifier to use, it is best to contact Aircash
                    support.
                </li>
                <li>
                    For the purpose of this verification, the partner system has to provide an access
                    point for Aircash to send parameters and to get an answer whether the entered
                    identifier is valid.
                </li>
            </ul>
        </li>
        <li>
            <b>User Invoice</b>
            <ul>
                <li>
                    After a successful check, the Aircash system will create a user template for the
                    payment transaction
                </li>
                <li>
                    The user is required to provide the funds and pay the above mentioned by selecting
                    one of the offered Aircash payment methods

                </li>
            </ul>
        </li>
        <li>
            <b>Payment to Partner Account (CreateAndConfirmTransaction)</b>
            <ul>
                <li>
                    After receiving funds, Aircash reports to the partner system that the user has made a
                    payment to the account (the unique identifier entered in step 1)
                </li>
                <li>
                    The partner system is obliged to provide an access point through which
                    funds are transferred to the user's system
                </li>
            </ul>
        </li>
    </ol>
</p>
<hr />
<h1 style="text-align:justify">Methods called by Aircash on the partner system</h1>
<p style="text-align:justify">
    The Partner should open two REST methods that receive JSON objects in order to successfully
    make payment of funds to the Partner Account.
</p>

<h2>CheckPlayer</h2>
<p style="text-align:justify">
    The method used for Aircash platform to verify whether the user has an active account in the
    partner system and to enable the display of useful information (such as the user account status).
</p>
<p style="text-align:justify">
    When agreeing to this method, Aircash will need a list of parameters that partner needs in
    order to uniquely determine which account is being subjected for payment. For example, if the user
    would like to make a payment to his account in the partner system, he will need to input
    parameter(s) that will identify his account in the partner system (e.g. username in partner system).
    Aircash system will send CheckPlayer request using input parameter(s) to partner system in order to
    verify if the account exists in partner system. Aircash system will not allow the user to make payment
    in case the partner system doesn’t respond positively to this request.
    <br />
    Aircash system will need a list of negative responses from partner system in order to map
    them in the system. In case the partner system responds negatively to this request, partner will need
    to send some unique error code. Those error codes need mapping in the Aircash system in order to
    display correct messages to the end user. Example error codes: user doesn’t exist in the system, user
    account blocked in partner system, user account not verified in partner system…
    <br />
    If the partner system has multiple user identifiers, Aircash can allow the user to choose which
    identifier to enter.
</p>

<div class="table-responsive">
    <table class="table  table-active col-md-6">
        <thead>
            <tr>
                <th>Environment</th>
                <th>Method</th>
                <th>URL</th>
                <th>IP addresse to whitelist</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><b>Test</b></td>
                <td>
                    POST
                </td>
                <td>URL defined by partner</td>
                <td>
                    212.83.162.238
                </td>
                <td>
                </td>
            </tr>
            <tr>
                <td><b>Production</b></td>
                <td>
                    POST
                </td>
                <td>URL defined by partner</td>
                <td>
                    212.129.36.132
                </td>
            </tr>
        </tbody>
    </table>
</div>

<uib-tabset>
    <uib-tab index="checkUser1-tab-0" heading="Request parameters" classes="nav-item">
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th colspan="2">Parameter</th>
                        <th>Type</th>
                        <th>Description</th>
                        <th>Mandatory</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td colspan="2"><b>Parameters</b></td>
                        <td>List &lt;Object&gt;</td>
                        <td>List of parameters</td>
                        <td>YES</td>
                    </tr>
                    <tr>
                        <td colspan="1"></td>
                        <td colspan="1"><b>Key</b></td>
                        <td>String</td>
                        <td>
                            The name of the parameter to be sent
                        </td>
                        <td>YES</td>
                    </tr>
                    <tr>
                        <td colspan="1"></td>
                        <td colspan="1"><b>Value</b></td>
                        <td>String</td>
                        <td>
                            The value of the parameter to be sent
                        </td>
                        <td>YES</td>
                    </tr>
                    <tr>
                        <td colspan="2"><b>Signature</b></td>
                        <td>String</td>
                        <td>
                            Signature by Aircash system confirming that Aircash is sending request to the partner system
                        </td>
                        <td>YES</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </uib-tab>
    <uib-tab index="checkUser1-tab-1" heading="Request example" classes="nav-item">
        <div class="form-group row mx-2">
            <div class="col-6">
                <div class="row">
                    <div class="col-lg-3 mt-2 ">
                        <select class="form-control" id="select" ng-change="requestCheckPlayerChanged()" ng-model="checkPlayerUsernameEmailSelected">
                            <option value="email">Email</option>
                            <option value="username">Username</option>
                        </select>
                    </div>
                    <div class="col-lg-9 mt-2">
                        <input ng-model="checkPlayerGenerateSignatureModel.identificator" ng-init="checkPlayerGenerateSignatureModel.identificator = ''" ng-keyup="requestCheckPlayerChanged()" class="form-control" type="text" placeholder="Enter {{checkPlayerUsernameEmailSelected}}" ng-disabled="generateCheckPlayerSignatureBusy" ng-required="true">
                    </div>
                </div>
                <hr />
                <div class="row">
                    <div class="col-lg-3 form-check align-self-center mt-2 pl-4">
                        <input class="form-check-input" type="checkbox" ng-change="requestCheckPlayerChanged()" ng-model="checkboxCheckPlayerModel.currency">
                        <label class="form-check-label">
                            CurrencyId
                        </label>
                    </div>
                    <div class="col-lg-9 mt-2">
                        <input ng-model="checkPlayerGenerateSignatureModel.currency" ng-init="checkPlayerGenerateSignatureModel.currency = ''" ng-if="checkboxCheckPlayerModel.currency" ng-change="requestCheckPlayerChanged()" class="form-control" type="text" placeholder="Enter currencyId e.g. 978" ng-disabled="generateCheckPlayerSignatureBusy" ng-required="true">
                    </div>
                </div>
                <hr />
                <div class="row">
                    <div class="col-lg-3 form-check align-self-center mt-2 pl-4">
                        <input class="form-check-input" type="checkbox" ng-change="requestCheckPlayerChanged()" ng-model="checkboxCheckPlayerModel.countryCode">
                        <label class="form-check-label">
                            CountryCode
                        </label>
                    </div>
                    <div class="col-lg-9 align-self-center">
                        <input ng-model="checkPlayerGenerateSignatureModel.countryCode" ng-init="checkPlayerGenerateSignatureModel.countryCode = ''" ng-if="checkboxCheckPlayerModel.countryCode" ng-change="requestCheckPlayerChanged()" class="form-control" type="text" placeholder="Enter countryCode e.g. HR" ng-disabled="generateCheckPlayerSignatureBusy" ng-required="true">
                    </div>
                </div>
                <hr />
                <div class="row">
                    <div class="col-lg-3 form-check align-self-center mt-2 pl-4">
                        <input class="form-check-input" type="checkbox" ng-change="requestCheckPlayerChanged()" ng-model="checkboxCheckPlayerModel.merchant">
                        <label class="form-check-label">
                            MerchantId
                        </label>
                    </div>
                    <div class="col-lg-9 mt-2">
                        <input ng-model="checkPlayerGenerateSignatureModel.merchantId" ng-init="checkPlayerGenerateSignatureModel.merchantId = ''" ng-if="checkboxCheckPlayerModel.merchant" ng-change="requestCheckPlayerChanged()" class="form-control" type="text" placeholder="Enter merchantId e.g. 100" ng-disabled="generateCheckPlayerSignatureBusy" ng-required="true">
                    </div>
                </div>
                <hr />
                <div class="row">
                    <div class="col-lg-3 form-check mt-2 pl-4">
                        <input class="form-check-input" type="checkbox" ng-change="requestCheckPlayerChanged()" ng-model="checkboxCheckPlayerModel.match">
                        <label class="form-check-label">
                            Match personal data
                        </label>
                    </div>
                    <div ng-if="checkboxCheckPlayerModel.match" class="col-lg-9 align-self-center mt-2">
                        <div>
                            <input ng-model="checkPlayerGenerateSignatureModel.firstname" ng-init="checkPlayerGenerateSignatureModel.firstname = ''" ng-change="requestCheckPlayerChanged()" class="form-control" type="text" placeholder="Enter firstname" ng-disabled="generateCheckPlayerSignatureBusy" ng-required="true">
                        </div>
                        <div class="mt-2">
                            <input ng-model="checkPlayerGenerateSignatureModel.lastname" ng-init="checkPlayerGenerateSignatureModel.lastname = ''" ng-change="requestCheckPlayerChanged()" class="form-control" type="text" placeholder="Enter lastname" ng-disabled="generateCheckPlayerSignatureBusy" ng-required="true">
                        </div>
                        <div class="mt-2">
                            <date-picker date="checkPlayerGenerateSignatureModel.birthDate" ng-init="checkPlayerGenerateSignatureModel.birthDate = ''" isOptional="false" out="checkPlayerSetDate"></date-picker>
                        </div>
                    </div>
                </div>
                <hr />
            </div>
            <div class="col-6">
                <div ng-if="checkPlayerChanged && !generateCheckPlayerSignatureResponded">
                    <jsonformatter data="aircashPayment.checkPlayer.requestExample"></jsonformatter>
                </div>
                <div ng-if="generateCheckPlayerSignatureResponded">
                    <jsonformatter data="generateCheckPlayerSignatureResponse"></jsonformatter>
                </div>
            </div>
        </div>
        <div class="col-12 d-flex justify-content-end">
            <button class="btn btn-white ml-2 mt-2" ng-if="generateCheckPlayerSignatureResponded" ng-click="copy(generateCheckPlayerSignatureResponse)">Copy</button>
            <button ng-click="generateCheckPlayerSignature()" class="btn btn-primary w-100px me-5px mt-2 ml-2" ng-disabled="generateCheckPlayerSignatureBusy">Generate signature<i ng-if="generateCheckPlayerSignatureBusy" class="fa fa-cog fa-spin"></i></button>
        </div>
    </uib-tab>
    <uib-tab index="CheckCode-tab-2" heading="Signature" classes="nav-item">
        <pre>
Request example:
</pre>
        <jsonformatter data="aircashPayment.checkPlayer.requestExample"></jsonformatter>
<pre>

Sequence:
Parameters=Key=username&Value=aircash

Signature:
HrlYnqqrhCJJuqnGtkLE03IDp0mPTzW4otIrFlIRg3tXIQXgTJJiy61vYQuWzV8AqBQoDiQlQvLVKvJQlqPcyncevT5DwAMVMdzQO2O7mP9hpP9lVmNrPLs3bTffHA7GkmrEnbg6+exD+wQKPeqric0tfVjJfoGLEq48+1/ndqXY+VqPdKdPQm23NWcWGytDr2Itrmw3a2pR9xbBkhChNT9X2WK+M9rPNzoGhZOFE2GHh/7/o4qJl0/ilCgi8uga1NK1z8Cl2fHQgxrJ/TcIGCW3/NmEvKX6YPXPoOPWXXB4wJ2pfHyNfTqt8klVYp0TpYcG+exYj9Vg7WJo90q9ZDtQFKp6GpXNLiNcZPzo0+Q251iPZfzIt2zPutkF/N93WnInEd6EvqXRn9P6FrC0GetcAhAx++p/i+ez3mRUgscdG9QHVQ3xPKl0u24yb9LvIzaBg9R6GcaZNBYdABjYV8vWIQY7Mkinp0gx4J+X/w8CVbdQvvS0GX0/WeMRnvYW34+I5uYcEkvqAB5BNYG/qVNi54e4qPYo7pxBjV/eXYdweWTIQ83icgFtuY4oEURJ5QUe5cq3yVePsOAw5pVzptwfxnJG/3zIoNGOf6EOvmVcAHLtgzzMNJi55wmqK+G8iZ/MG8YgRpUl78pJYAaA4iyWgpgtoqMAH4CHmi0uCgs=
</pre>
    </uib-tab>
    <uib-tab index="checkUser1-tab-3" heading="Response parameters" classes="nav-item">
        <div class="row">
            <div class="col-md-12">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th colspan="3">Return value</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="3"><b>IsPlayer</b></td>
                                <td>Bool</td>
                                <td>
                                    True if there is an account with the above data
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3"><b>Error</b></td>
                                <td></td>
                                <td>
                                    In case of returning an error (IsPlayer = false), return
                                    the corresponding error to get the user the correct
                                    error
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td><b>ErrorCode</b></td>
                                <td>Int</td>
                                <td>
                                    Error codes and error messages are sent to user
                                    support for mapping to be printed in the mobile
                                    application.
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td><b>ErrorMessage</b></td>
                                <td>String</td>
                                <td>
                                    Error description.
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3"><b>Parameters</td>
                                <td>List &lt;Object&gt;</td>
                                <td>
                                    This parameter can be ignored if the user does not
                                    need to show additional information in the mobile
                                    app. In addition to the parameters, some values may
                                    be reversed by which the Aircash system defines
                                    different rules for this transaction, such as minimum
                                    transaction amount or maximum transaction
                                    amount. The parameters are agreed in cooperation
                                    with Aircash support.
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td><b>Key</b></td>
                                <td>String</td>
                                <td>Parameter name</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td><b>Type</b></td>
                                <td>String</td>
                                <td>
                                    Parameter type: String, Date, Decimal, DateTime,
                                    Boolean
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td><b>Value</b></td>
                                <td>String</td>
                                <td>Parameter value</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </uib-tab>
    <uib-tab index="checkUser1-tab-4" heading="200 OK response example" classes="nav-item">
        <jsonformatter data="aircashPayment.checkPlayer.responseExample"></jsonformatter>
    </uib-tab>
    <uib-tab index="checkUser1-tab-6" heading="Error response example" classes="nav-item">
        <jsonformatter data="aircashPayment.checkPlayer.errorResponseExample"></jsonformatter>
    </uib-tab>
</uib-tabset>

<h2 style="text-align:justify">CreateAndConfirmPayment</h2>
<p style="text-align:justify">
    The method used to let the Aircash platform notify the partner system that the payment has
    been made and that the user's account should be charged with the specified amount.
</p>
<p style="text-align: justify">
    When agreeing to this method, Aircash will send the same parameters as for the CheckPayer
    method to identify the reimbursement account.
</p>
<uib-tabset>
    <uib-tab index="CreateAndConfirmPayment1-tab-0" heading="Request parameters" " classes="nav-item">
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th colspan="2">Parameter</th>
                        <th>Type</th>
                        <th>Description</th>
                        <th>Mandatory</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td colspan="2"><b>TransactionID</b></td>
                        <td>String</td>
                        <td>Id of transactions in the Aircash system</td>
                        <td>YES</td>
                    </tr>
                    <tr>
                        <td colspan="2"><b>Amount</b></td>
                        <td>Decimal</td>
                        <td>Transaction Amount</td>
                        <td>YES</td>
                    </tr>
                    <tr>
                        <td colspan="2"><b>Parameters</b></td>
                        <td>List&lt;Object&gt;</td>
                        <td>
                            A list of parameters that uniquely define
                            a user's account for a supplement of
                            funds
                        </td>
                        <td>YES</td>
                    </tr>
                    <tr>
                        <td colspan="1"></td>
                        <td colspan="1"><b>Key</b></td>
                        <td>String</td>
                        <td>
                            The name of the parameter to be sent
                        </td>
                        <td>YES</td>
                    </tr>
                    <tr>
                        <td colspan="1"></td>
                        <td colspan="1"><b>Value</b></td>
                        <td>String</td>
                        <td>
                            The value of the parameter to be sent
                        </td>
                        <td>YES</td>
                    </tr>
                    <tr>
                        <td colspan="2"><b>Signature</b></td>
                        <td>String</td>
                        <td>
                            Signature by Aircash system confirming that Aircash is sending request to the partner system
                        </td>
                        <td>YES</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </uib-tab>
    <uib-tab index="CreateAndConfirmPayment1-tab-1" heading="Request example" classes="nav-item">
        <div class="form-group row mx-2">
            <div class="col-6">
                <div class="row">
                    <div class="col-lg-3 align-self-center mt-3 pl-3">
                        <label>
                            Amount
                        </label>
                    </div>
                    <div class="col-lg-9 mt-2">
                        <input ng-model="createAndConfirmGenerateSignatureModel.amount"  ng-change="requestCreateAndConfirmChanged()" class="form-control" type="number" placeholder="Enter amount" ng-disabled="generateCreateAndConfirmSignatureBusy" ng-required="true">
                    </div>
                </div>
                <hr />
                <div class="row">
                    <div class="col-lg-3 mt-2 ">
                        <select class="form-control" id="select2" ng-change="requestCreateAndConfirmChanged()" ng-model="createAndConfirmUsernameEmailSelected">
                            <option value="email">Email</option>
                            <option value="username">Username</option>
                        </select>
                    </div>
                    <div class="col-lg-9 mt-2">
                        <input ng-model="createAndConfirmGenerateSignatureModel.identificator" ng-init="createAndConfirmGenerateSignatureModel.identificator=''" ng-keyup="requestCreateAndConfirmChanged()" class="form-control" type="text" placeholder="Enter {{CreateAndConfirmUsernameEmailSelected}}" ng-disabled="generateCreateAndConfirmSignatureBusy" ng-required="true">
                    </div>
                </div>
                <hr />
                <div class="row">
                    <div class="col-lg-3 form-check align-self-center mt-2 pl-4">
                        <input class="form-check-input" type="checkbox" ng-change="requestCreateAndConfirmChanged()" ng-model="checkboxCreateAndConfirmModel.currency">
                        <label class="form-check-label">
                            CurrencyId
                        </label>
                    </div>
                    <div class="col-lg-9 mt-2">
                        <input ng-model="createAndConfirmGenerateSignatureModel.currency"  ng-init="createAndConfirmGenerateSignatureModel.currency=''" ng-if="checkboxCreateAndConfirmModel.currency" ng-change="requestCreateAndConfirmChanged()" class="form-control" type="text" placeholder="Enter currencyId e.g. 978" ng-disabled="generateCreateAndConfirmSignatureBusy" ng-required="true">
                    </div>
                </div>
                <hr />
                <div class="row">
                    <div class="col-lg-3 form-check align-self-center mt-2 pl-4">
                        <input class="form-check-input" type="checkbox" ng-change="requestCreateAndConfirmChanged()" ng-model="checkboxCreateAndConfirmModel.countryCode">
                        <label class="form-check-label">
                            CountryCode
                        </label>
                    </div>
                    <div class="col-lg-9 align-self-center">
                        <input ng-model="createAndConfirmGenerateSignatureModel.countryCode"  ng-init="createAndConfirmGenerateSignatureModel.countryCode=''" ng-if="checkboxCreateAndConfirmModel.countryCode" ng-change="requestCreateAndConfirmChanged()" class="form-control" type="text" placeholder="Enter countryCode e.g. HR" ng-disabled="generateCreateAndConfirmSignatureBusy" ng-required="true">
                    </div>
                </div>
                <hr />
                <div class="row">
                    <div class="col-lg-3 form-check align-self-center mt-2 pl-4">
                        <input class="form-check-input" type="checkbox" ng-change="requestCreateAndConfirmChanged()" ng-model="checkboxCreateAndConfirmModel.merchant">
                        <label class="form-check-label">
                            MerchantId
                        </label>
                    </div>
                    <div class="col-lg-9 mt-2">
                        <input ng-model="createAndConfirmGenerateSignatureModel.merchantId"  ng-init="createAndConfirmGenerateSignatureModel.merchantId=''" ng-if="checkboxCreateAndConfirmModel.merchant" ng-change="requestCreateAndConfirmChanged()" class="form-control" type="text" placeholder="Enter merchantId e.g. 100" ng-disabled="generateCreateAndConfirmSignatureBusy" ng-required="true">
                    </div>
                </div>
                <hr />
                <div class="row">
                    <div class="col-lg-3 form-check mt-2 pl-4">
                        <input class="form-check-input" type="checkbox" ng-change="requestCreateAndConfirmChanged()" ng-model="checkboxCreateAndConfirmModel.match">
                        <label class="form-check-label">
                            Match personal data
                        </label>
                    </div>
                    <div ng-if="checkboxCreateAndConfirmModel.match" class="col-lg-9 align-self-center mt-2">
                        <div>
                            <input ng-model="createAndConfirmGenerateSignatureModel.firstname"  ng-init="createAndConfirmGenerateSignatureModel.firstname=''" ng-change="requestCreateAndConfirmChanged()" class="form-control" type="text" placeholder="Enter firstname" ng-disabled="generateCreateAndConfirmSignatureBusy" ng-required="true">
                        </div>
                        <div class="mt-2">
                            <input ng-model="createAndConfirmGenerateSignatureModel.lastname"  ng-init="createAndConfirmGenerateSignatureModel.lastname=''" ng-change="requestCreateAndConfirmChanged()" class="form-control" type="text" placeholder="Enter lastname" ng-disabled="generateCreateAndConfirmSignatureBusy" ng-required="true">
                        </div>
                        <div class="mt-2">
                            <date-picker date="createAndConfirmGenerateSignatureModel.birthDate"  ng-init="createAndConfirmGenerateSignatureModel.birthDate=''" isOptional="false" out="createAndConfirmSetDate"></date-picker>
                        </div>
                    </div>
                </div>
                <hr />
            </div>
            <div class="col-6">
                <div ng-if="createAndConfirmChanged && !generateCreateAndConfirmSignatureResponded">
                    <jsonformatter data="aircashPayment.createAndConfirmPayment.requestExample"></jsonformatter>
                </div>
                <div ng-if="generateCreateAndConfirmSignatureResponded">
                    <jsonformatter data="generateCreateAndConfirmSignatureResponse"></jsonformatter>
                </div>
            </div>
        </div>
        <div class="col-12 d-flex justify-content-end">
            <button class="btn btn-white ml-2 mt-2" ng-if="generateCreateAndConfirmSignatureResponded" ng-click="copy(generateCreateAndConfirmSignatureResponse)">Copy</button>
            <button ng-click="generateCreateAndConfirmSignature()" class="btn btn-primary w-100px me-5px mt-2 ml-2" ng-disabled="generateCreateAndConfirmSignatureBusy">Generate signature<i ng-if="generateCreateAndConfirmSignatureBusy" class="fa fa-cog fa-spin"></i></button>
        </div>

    </uib-tab>
    <uib-tab index="CheckCode-tab-2" heading="Signature" classes="nav-item">
        <pre>
Request example:
</pre>
        <jsonformatter data="aircashPayment.createAndConfirmPayment.requestExample"></jsonformatter>
<pre>

Sequence:
Amount=123.45&Parameters=Key=username&Value=aircash&TransactionID=c1cf13b4-52ce-4b2f-9f9b-9d31cc1f800a

Signature:
Gng+D6+3v5dPCIXMJFcO7TAjfstMS8d9YFjCSDvDtGyu3DG7tlmKxJkFYWnKthNAAKi5OwnLRLK4HwdiNNda6gOJffI8ZVOFgPLbLuDhEVzJ/gwKKeNa6MqPxo3Us4VKbhPKdMgQoSS5zQp3w6ptSdey58iU/hxzMi/9PyaGYGYRsYGohInm721AyYnBFAmXe8az6efPsUnQT9YQGSechYRadF1QpBjVs2yNwnFz3p9IdhIqYPVetq5PXlrTtv8FGJ6ocK38imNVZrhxbciIIRDsCP6DxBvKYRY16yBEqJwLsSxmfx9ZZTkilkWtANczDnPHbl3x5FZNnmD2WC4MHgGabgyzQGn+zF3+Kf2m9mJZI7CT0nU9ZQLWM3Q+zkcmWC/mPpmDD3rKORPPIqT7M3aMEG8k+M1gNmvdaR/Xw8x1CCwINSQ3osYEghaZN+m+0H9ilx0NZVTOWyP3U8m0vzm7Cd3uc6h4z3LHirOr0DaFp6hk3/5fSwAbLATghQi3IkYuc9lJCenC5BXhWxrDkcby5foBqxDQcTolVKwOCSyO5r9j+DzzsXYcopNwlBfl9ZclRqYMQK9io9fbeu5RSCKa/jQv+q9Va9XA0T/He+KWUyK47yCVzOBcgoBurc+ycdbnPttrGbLiNuqicOnXIwZuHHN0krKzSmTOthyqP/4=
</pre>
    </uib-tab>
    <uib-tab index="CreateAndConfirmPayment1-tab-3" heading="Response parameters" classes="nav-item">
        <div class="row">
            <div class="col-md-12">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th colspan="3">Return value</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="3"><b>Success</b></td>
                                <td>Bool</td>
                                <td>
                                    True if payment is successful, otherwise false
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3"><b>PartnerTransactionID</b></td>
                                <td>String</td>
                                <td>
                                    Transaction ID in partner system, must be unique.
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3"><b>Error</b></td>
                                <td>Object</td>
                                <td>
                                    In case of error, return the corresponding error so
                                    that the user can see what went wrong
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td><b>ErrorCode</b></td>
                                <td>Int</td>
                                <td>
                                    Possible error codes and error messages mappings
                                    should be sent to user support, so they can be
                                    displayed in the mobile application.
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td><b>ErrorMessage</b></td>
                                <td>String</td>
                                <td>
                                    Error description.
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3"><b>Parameters</b></td>
                                <td>List &lt;Object&gt;</td>
                                <td>
                                    The List of objects of type ParameterRS. In the event
                                    that some additional parameters have to be shown
                                    to the user, they can be returned in this object. The
                                    parameters are agreed in cooperation with Aircash
                                    support.
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td><b>Key</b></td>
                                <td>String</td>
                                <td>Parameter name</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td><b>Type</b></td>
                                <td>String</td>
                                <td>
                                    Parameter type: String, Date, Decimal, DateTime,
                                    Boolean
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td><b>Value</b></td>
                                <td>String</td>
                                <td>Parameter value</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </uib-tab>
    <uib-tab index="CreateAndConfirmPayment1-tab-4" heading="200 OK response example" classes="nav-item">
        <jsonformatter data="aircashPayment.createAndConfirmPayment.responseExample"></jsonformatter>
    </uib-tab>
    <uib-tab index="CreateAndConfirmPayment1-tab-5" heading="Error response example" classes="nav-item">
        <jsonformatter data="aircashPayment.createAndConfirmPayment.errorResponseExample"></jsonformatter>
    </uib-tab>
</uib-tabset>
<h2 style="text-align:justify">Signature</h2>
<i>Aircash public keys:</i>
<div class="table-responsive">
    <table class="table table-active col-md-2">
        <thead>
            <tr>
                <th>Environment</th>
                <th>Download</th>
            </tr>
        </thead>
        <tr>
            <td><b>Test</b></td>
            <td><a href="/files/AircashPaymentPublicKeyTest.zip" download>Link</a></td>
        </tr>
        <tr>
            <td><b>Production</b></td>
            <td><a href="/files/AircashPaymentPublicKeyProd.zip" download>Link</a></td>
        </tr>
    </table>
</div>

<h2 style="text-align:justify">Erorr code examples</h2>
<div class="table-responsive">
    <table class="table table-active">
        <thead>
            <tr>
                <th>Error code</th>
                <th>Error message</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td>account_not_activated</td>
                <td>Your account is not activated as you have not confirmed your email. Please first confirm your email.</td>
            </tr>
            <tr>
                <td>2</td>
                <td>account_shutdown_info</td>
                <td>Your account is suspended. Please contact support if you have any inquiries.</td>
            </tr>
            <tr>
                <td>3</td>
                <td>customer_payment_deposit_limit</td>
                <td>The deposit was not accepted because you have reached your limits of deposits.</td>
            </tr>
            <tr>
                <td>4</td>
                <td>account_not_found</td>
                <td>Account not found.</td>
            </tr>
            <tr>
                <td>5</td>
                <td>payment_already_confirmed_in_partner_system_error_code</td>
                <td>Payment Already Confirmed In Partner System Error Code.</td>
            </tr>
        </tbody>
    </table>
</div>
<hr />

<h1 style="text-align:justify">Deep link</h1>
<p>
    Payment process through Aircash application is described in previous chapters. In order to
    simplify the process for new, but also for existing users, Aircash proposes to partners to integrate
    deep link option inside their app.
</p>
<p>
    In deep link option, the user can initiate payment from partner web/mobile application.
    Integration process is easy, and user gets simple and user friendly way of payment from the partner
    website or mobile application.
</p>
<p>
    From user perspective flow is following:
    <ol>
        <li>
            User select Aircash as payment method on the partner site. The user inputs the
            amount that the user would like to deposit on his Aircash account.
        </li>
        <li>
            After the user confirms payment on the partner site, the user will be redirected on
            specific location based on the user’s device:
            <ol type="a">
                <li>
                    User is on a mobile device:
                    <ol type="i">
                        <li>
                            If a user has the Aircash app installed, it will pop up with the already prefilled amount and username/email.
                        </li>
                        <li>
                            If a user does not have the Aircash app (i.e., the phone number does not exists), a user will be just redirected to the info page where he can see how to download the Aircash app and open the account.
                        </li>
                    </ol>
                </li>
                <li>
                    User is on a desktop device:
                    <ol type="i">
                        <li>
                            If a user has the Aircash app installed, he will receive a push notification that will open his Aircash app with the already prefilled amount and username/email. His browser will be redirected to the Aircash info page where some short guidelines are stated. From the info page, there will be a back button for your cashier.
                        </li>
                        <li>
                            If a user does not have the Aircash app (i.e., the phone number does not exist), a user will be just redirected to the info page where he can see how to download the Aircash app and open the account.
                        </li>
                    </ol>
                </li>
            </ol>
        </li>
    </ol>
</p>

<h2 style="text-align:justify">Integration</h2>
<p>
    In deep link integration process, the partner needs to generate payment link with correct
    parameters. Aircash will send partner correct link once parameters for the link are defined.
    Parameter list is different for each partner, but parameter list in deep link option are same as in
    payment integration.
</p>
<p>
    Link example
    <div class="row ml-1">
        <select class="form-control form-control-sm col-md-2 col-3" ng-model="isProduction" ng-init="isProduction = false">
            <option ng-value="true">Production</option>
            <option ng-value="false">Test</option>
        </select>
        <select class="form-control form-control-sm col-md-2 col-3 ml-2" ng-model="identificator" ng-init="identificator = 'username'">
            <option ng-value="'email'">Email</option>
            <option ng-value="'username'">Username</option>
        </select>
    </div>
    <br />
    <div class="overflow-auto" ng-if="!isProduction">
        <a href="">https://aircashtest.page.link/?link=https://staging-m3.aircash.eu/api/DeepLink/PartnerPayment?partnerID%3D<b class="text-danger">{partnerId}</b>%26{{identificator}}%3D<b class="text-danger">{<span>{{identificator}}</span>}</b>%26amount%3D<b class="text-danger">{amount}</b>%26phoneNumber%3D<b class="text-danger">{phoneNumber}</b>&apn=com.aircash.aircash.test&afl=https://staging-m3.aircash.eu/api/DeepLink/PartnerPayment?partnerID%3D<b class="text-danger">{partnerId}</b>%26{{identificator}}%3D<b class="text-danger">{<span>{{identificator}}</span>}</b>%26amount%3D<b class="text-danger">{amount}</b>%26phoneNumber%3D<b class="text-danger">{phoneNumber}</b>&isi=1178612530&ibi=com.aircash.aircash.test&ifl=https://staging-m3.aircash.eu/api/DeepLink/PartnerPayment?partnerID%3D<b class="text-danger">{partnerId}</b>%26{{identificator}}%3D<b class="text-danger">{<span>{{identificator}}</span>}</b>%26amount%3D<b class="text-danger">{amount}</b>%26phoneNumber%3D<b class="text-danger">{phoneNumber}</b>&utm_campaign=<b class="text-danger">{partnerName}</b>_topup&utm_medium=deeplink&utm_source=<b class="text-danger">{partnerName}</b></a>
        <br />
    </div>
    <div class="overflow-auto" ng-if="isProduction">
        <a href="">https://aircash.page.link/?link=https://m3.aircash.eu/api/DeepLink/PartnerPayment?partnerID%3D<b class="text-danger">{partnerId}</b>%26{{identificator}}%3D<b class="text-danger">{<span>{{identificator}}</span>}</b>%26amount%3D<b class="text-danger">{amount}</b>%26phoneNumber%3D<b class="text-danger">{phoneNumber}</b>&apn=com.aircash.aircash&afl=https://m3.aircash.eu/api/DeepLink/PartnerPayment?partnerID%3D<b class="text-danger">{partnerId}</b>%26{{identificator}}%3D<b class="text-danger">{<span>{{identificator}}</span>}</b>%26amount%3D<b class="text-danger">{amount}</b>%26phoneNumber%3D<b class="text-danger">{phoneNumber}</b>&isi=1178612530&ibi=com.aircash.aircash&ifl=https://m3.aircash.eu/api/DeepLink/PartnerPayment?partnerID%3D<b class="text-danger">{partnerId}</b>%26{{identificator}}%3D<b class="text-danger">{<span>{{identificator}}</span>}</b>%26amount%3D<b class="text-danger">{amount}</b>%26phoneNumber%3D<b class="text-danger">{phoneNumber}</b>&utm_campaign=<b class="text-danger">{partnerName}</b>_topup&utm_medium=deeplink&utm_source=<b class="text-danger">{partnerName}</b></a>
        <br />
    </div>
</p>
<p>
    In this case partner needs to replace 4 parameters values (marked in red):
    <ul>
        <li>
            {partnerID} - replace with partnerID with partner identifier in Aircash system. Aircash will
            send you this information once Aircash opens account for partner in Aircash system.
        </li>
        <li>
            {<span>{{identificator}}</span>} - replace with user's {{identificator}}
        </li>
        <li>
            {amount} - amount that user inputed in partner system. Amount must be whole number
            without decimal or thousands separator. Example 1234
        </li>
        <li>
            {phoneNubmer} - unique identifier for user in Aircash application. In case the user attempts
            to make payment via desktop PC, Aircash system will find user by phoneNubmer and send him notification with transaction template. Once user open notification on this mobile device
            Aircash application will start and prefill all parameters of the transaction; user will need to
            authorize transaction and partner will receive payment confirmation request
        </li>
        <li>
            {partnerName} - replace with partner's name
        </li>
    </ul>
</p>
<p>
    Result link should look like this:
    <br />
    <div class="row row-cols-md-4 row-cols-lg-6 row-cols-2">
        <div class="col form-group mr-2">
            <label>PartnerId:</label>
            <input class="form-control form-control-sm" ng-model="partnerId" ng-init="partnerId = '8F62C8F0-7155-4C0E-8EBE-CD9357CFD1BF'" />
        </div>
        <div class="col form-group mr-2">
            <label>{{identificator.charAt(0).toUpperCase() + identificator.slice(1)}}:</label>
            <input class="form-control form-control-sm" ng-model="username" ng-init="username = 'test'" />
        </div>
        <div class="col form-group mr-2">
            <label>Amount:</label>
            <input class="form-control form-control-sm" ng-model="amount" ng-init="amount = '100'" />
        </div>
        <div class="col form-group mr-2">
            <label>Phonenumber:</label>
            <input class="form-control form-control-sm" ng-model="phoneNumber" ng-init="phoneNumber = '385981234567'" />
        </div>
        <div class="col form-group mr-2">
            <label>Partner Name:</label>
            <input class="form-control form-control-sm" ng-model="partnerName" ng-init="partnerName = 'Brand'" />
        </div>

    </div>
    <div class="overflow-auto" ng-if="!isProduction">
        <a href="" id="testLink">https://aircashtest.page.link/?link=https://staging-m3.aircash.eu/api/DeepLink/PartnerPayment?partnerID%3D{{partnerId}}%26{{identificator}}%3D{{username}}%26amount%3D{{amount}}%26phoneNumber%3D{{phoneNumber}}&apn=com.aircash.aircash.test&afl=https://staging-m3.aircash.eu/api/DeepLink/PartnerPayment?partnerID%3D{{partnerId}}%26{{identificator}}%3D{{username}}%26amount%3D{{amount}}%26phoneNumber%3D{{phoneNumber}}&isi=1178612530&ibi=com.aircash.aircash.test&ifl=https://staging-m3.aircash.eu/api/DeepLink/PartnerPayment?partnerID%3D{{partnerId}}%26{{identificator}}%3D{{username}}%26amount%3D{{amount}}%26phoneNumber%3D{{phoneNumber}}&utm_campaign={{partnerName}}_topup&utm_medium=deeplink&utm_source={{partnerName}}</a>
        <br />
        <button class="btn btn-sm btn-white mt-2" ng-click="copyToClipboard(isProduction)">Copy</button>
    </div>
    <div class="overflow-auto" ng-if="isProduction">
        <a href="" id="prodLink">https://aircash.page.link/?link=https://m3.aircash.eu/api/DeepLink/PartnerPayment?partnerID%3D{{partnerId}}%26{{identificator}}%3D{{username}}%26amount%3D{{amount}}%26phoneNumber%3D{{phoneNumber}}&apn=com.aircash.aircash&afl=https://m3.aircash.eu/api/DeepLink/PartnerPayment?partnerID%3D{{partnerId}}%26{{identificator}}%3D{{username}}%26amount%3D{{amount}}%26phoneNumber%3D{{phoneNumber}}&isi=1178612530&ibi=com.aircash.aircash&ifl=https://m3.aircash.eu/api/DeepLink/PartnerPayment?partnerID%3D{{partnerId}}%26{{identificator}}%3D{{username}}%26amount%3D{{amount}}%26phoneNumber%3D{{phoneNumber}}&utm_campaign={{partnerName}}_topup&utm_medium=deeplink&utm_source={{partnerName}}</a>
        <br />
        <button class="btn btn-sm btn-white mt-2" ng-click="copyToClipboard(isProduction)">Copy</button>
    </div>
</p>
<p>
    Links in this document will not work (first link doesn’t have the partner identificator, and
    second link has non existing partner id) as they are stated just like example.
</p>
<p>
    Links for test and production can be different so Aircash proposes link parametrization and
    use of simple replace function to insert parameters (just like in example) because the name of the
    parameters will be the same in test and in production.
</p>
<hr />
<h1 style="text-align:justify">Production process</h1>
<p>
    The production process consists of several steps that take place sequentially:
    <ol>
        <li>
            All acceptance criteria are checked and are performing in line with expectations
        </li>
        <li>
            The partner will push his service to production and define addresses for CheckPlayer and
            CreateAndConfirmTransaction method
        </li>
        <li>
            Aircash will enable the partner payment option for several users in Aircash application to
            test integration in production environment
        </li>
        <li>
            After the first 3 steps are in line with expectations, Aircash will enable partner payment
            for all users
        </li>
    </ol>
</p>

<h2 style="text-align:justify">Acceptance criteria</h2>
<p>
    To release the service in the production, you need to make several tests to see if the integration is
    well-made and ready for production
    <div class="table-responsive">
        <table class="table table-active">
            <thead>
                <tr>
                    <th>Scenario</th>
                    <th>Test description</th>
                    <th>Mandatory</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><b>Successful player verification</b></td>
                    <td>
                        The check player method returns true only to users
                        that are able to receive money via Aircash
                        application.
                    </td>
                    <td>YES</td>
                </tr>
                <tr>
                    <td><b>Unsuccessful player verification</b></td>
                    <td>
                        The partner system returns appropriate error code
                        in case when user is not able to receive money via
                        Aircash application.
                    </td>
                    <td>YES</td>
                </tr>
                <tr>
                    <td><b>Successful verification with additional parameters</b></td>
                    <td>
                        The method returns additional parameters with
                        agreed names and parameter types.
                    </td>
                    <td>
                        YES, if additional
                        parameters are agreed
                        for this method
                    </td>
                </tr>
                <tr>
                    <td><b>Payment confirmation</b></td>
                    <td>
                        The partner system insert transaction in the partner
                        system. The partner system returns valid response
                        to Aircash system with unique transaction identifier.
                    </td>
                    <td>YES</td>
                </tr>
                <tr>
                    <td><b>Payment confirmation with the same TransactionID</b></td>
                    <td>
                        The partner system reject transaction with error
                        code that is associated with not unique
                        transactionID
                    </td>
                    <td>YES</td>
                </tr>
                <tr>
                    <td><b>Payment confirmation with additional parameters </b></td>
                    <td>
                        The method returns additional parameters with
                        agreed names and parameter types in case of a new
                        transaction and in the case of transactions with the
                        same transaction ID
                    </td>
                    <td>
                        YES, if additional
                        parameters are agreed
                        for this method
                    </td>
                </tr>
                <tr>
                    <td><b>Deep link test</b></td>
                    <td>
                        Check if generated link is well formatted and it all
                        parameters are inputted correctly
                    </td>
                    <td>
                        YES, if partner uses
                        deep link option
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</p>
<hr />

<h1>FAQ</h1>

<br />

<div class="table-responsive">
    <table class="table table-active">
        <tr>
            <td rowspan="2">1.</td>
            <td>
                <b>Q:&nbsp;How to initiate a transaction in the sandbox environment?</b><br />
            </td>
        </tr>
        <tr>
            <td><b>A:</b>&nbsp; Aircash integration team will share the Aircash test app using which you can make a deposit</td>
        </tr>
        <tr>
            <td rowspan="2">2.</td>
            <td><b>Q:&nbsp; What are the min and max transaction amounts?</b></td>
        </tr>
        <tr>
            <td><b>A:</b>&nbsp; Min 1,00 EUR, Max 1.000,00 EUR</td>
        </tr>
        <tr>
            <td rowspan="2">3.</td>
            <td><b>Q:&nbsp; Does the user need to enter every time identifier (username, email) when making deposits?</b></td>
        </tr>
        <tr>
            <td><b>A:</b>&nbsp; After the first successful deposit, the identifier will be saved on the Aircash marketplace and prefilled for each next deposit.</td>
        </tr>
        <tr>
            <td rowspan="2">4.</td>
            <td><b>Q:&nbsp;  Can the user use more than one identifier?</b></td>
        </tr>
        <tr>
            <td><b>A:</b>&nbsp; Yes, he can. Aircash can allow the user to choose which identifier to enter.</td>
        </tr>
        <tr>
            <td rowspan="2">5.</td>
            <td><b>Q:&nbsp; How does the deposit via deep link work?</b></td>
        </tr>
        <tr>
            <td>
                <b>A:</b>&nbsp; After the user confirms the deposit on the online cashier, he will receive the deposit
                push notification and by confirming it, he will be redirected to the partner's marketplace window within the
                Aircash app. In case of the mobile browser, after confirming the transaction, the Aircahs app will open automatically
                (without push notification)
            </td>
        </tr>
    </table>
</div>